5+5
install.packages("tidyverse")
library(dplyr)
setwd("~/1_DB_Shared/0_um/sem_2/WQD7004 Programming for DSc/9 assignments/Group_Project")
setwd("~/1_DB_Shared/0_um/sem_2/WQD7004 Programming for DSc/9 assignments/Group_Project/wqd7004-group-project")
scr_dir<-dirname(rstudioapi::getSourceEditorContext()$path)
library(rstudioapi)
scr_dir<-dirname(rstudioapi::getSourceEditorContext()$path)
print(scr_dir)
source("~/1_DB_Shared/0_um/sem_2/WQD7004 Programming for DSc/9 assignments/Group_Project/wqd7004-group-project/R_files/clus_model.R", echo=TRUE)
main_dir<- dirname(dirname(rstudioapi::getSourceEditorContext()$path))
datadir<- paste0(main_dir,"/data")
clus_data_path<- paste0(datadir,"/data_c.csv")
clus_data<- read.csv(clus_data_path)
head(clus_data)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(scales)
library(tidyr)
library(rstudioapi)
main_dir<- dirname(dirname(rstudioapi::getSourceEditorContext()$path))
datadir<- paste0(main_dir,"/data")
data_path<- paste0(datadir,"/data.csv")
df=read.csv(data_path)
head(df)
df$sampling_date=NULL
df$stn_code=NULL
df$agency=NULL
df$location_monitoring_station=NULL
head(df)
df$type[df$type %in% "Residential, Rural and other Areas"] <- "Residential"
df$type[df$type %in% "Residential and others"] <- "Residential"
df$type[df$type %in% "Industrial Area"] <- "Industrial"
df$type[df$type %in% "Industrial Areas"] <- "Industrial"
df$type[df$type %in% "RIRUO"] <- "Others"
df$type[df$type %in% "Sensitive"] <- "Others"
df$type[df$type %in% "Sensitive Areas"] <- "Others"
df$type[df$type %in% "Sensitive Area"] <- "Others"
df$type[is.na(df$type)]= "Others"
df <- df %>% mutate(so2 = if_else(so2>500, mean(df$so2), df$so2))
df <- df %>% mutate(no2 = if_else(no2>500, mean(df$no2), df$no2))
df <- df %>% mutate(rspm = if_else(rspm>2000, mean(df$rspm), df$rspm))
df <- df %>% mutate(spm = if_else(spm>2000, mean(df$spm), df$spm))
df <- df %>% mutate(pm2_5 = if_else(pm2_5>350, mean(df$pm2_5), df$pm2_5))
par(mfrow=c(1,5))
boxplot(df$so2,
main = "Boxplot for so2",
col = "orange",
border = "brown",
notch = TRUE)
boxplot(df$no2,
main = "Boxplot for no2",
col = "orange",
border = "brown",
notch = TRUE)
boxplot(df$rspm,
main = "Boxplot for rspm",
col = "orange",
border = "brown",
notch = TRUE)
boxplot(df$spm,
main = "Boxplot for spm",
col = "orange",
border = "brown",
notch = TRUE)
boxplot(df$pm2_5,
main = "Boxplot for pm2_5",
col = "orange",
border = "brown",
notch = TRUE)
df_c=df
df_c$pm2_5=NULL
df_c$date=NULL
head(df_c)
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
df_c$so2[is.na(df$so2)]= mean(df_c$so2, na.rm = TRUE)
df_c$no2[is.na(df$no2)]= mean(df_c$no2, na.rm = TRUE)
df_c$rspm[is.na(df$rspm)]= mean(df_c$rspm, na.rm = TRUE)
df_c$spm[is.na(df$spm)]= mean(df_c$spm, na.rm = TRUE)
#df_c <- df_c %>% na.omit(df_c)
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
df_c$so2[is.na(df$so2)]= mean(df_c$so2, na.rm = TRUE)
df_c$no2[is.na(df$no2)]= mean(df_c$no2, na.rm = TRUE)
df_c$rspm[is.na(df$rspm)]= mean(df_c$rspm, na.rm = TRUE)
df_c$spm[is.na(df$spm)]= mean(df_c$spm, na.rm = TRUE)
df_c <- df_c %>% na.omit(df_c)
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
head(df_c)
str(df_c)
df_c=df
df_c$pm2_5=NULL
df_c$date=NULL
head(df_c)
data_c_path = paste0(datadir, "/data_c.csv")
write.csv(df_c,"data_c.csv", row.names=FALSE)
clus_data<- read.csv(clus_data_path)
head(clus_data)
data_c_path = paste0(datadir, "/data_c.csv")
write.csv(df_c, data_c_path, row.names=FALSE)
clus_data<- read.csv(clus_data_path)
head(clus_data)
print(colnames(clus_data))
print(nro(clus_data))
print(nrow(clus_data))
for (col in colnames(clus_data) ){
num_na = sum(is.na(clus_data[col]))
print(paste(col, num_na))
}
for (col in colnames(clus_data) ){
num_na = sum(is.na(clus_data[col]))
perc_na = 100*num_na/num_obs
print(paste(col, num_na))
}
num_obs = nrow(clus_data)
for (col in colnames(clus_data) ){
num_na = sum(is.na(clus_data[col]))
perc_na = 100*num_na/num_obs
print(paste(col, num_na))
}
for (col in colnames(clus_data) ){
num_na = sum(is.na(clus_data[col]))
perc_na = 100*num_na/num_obs
print(paste(col, num_na, perc_na))
}
loc_data<- df_c %>% group_by(location) %>%
summarise(mean_so2 = mean(so2, na.rm=TRUE),
mean_no2 = mean(no2, na.rm=TRUE),
mean_rspm = mean(rspm, na.rm=TRUE),
mean_spm = mean(spm, na.rm=TRUE)
)
head(loc_data)
main_dir<- dirname(dirname(rstudioapi::getSourceEditorContext()$path))
datadir<- paste0(main_dir,"/data")
clus_data_path<- paste0(datadir,"/data_c.csv")
clus_data<- read.csv(clus_data_path)
head(clus_data)
print(colnames(clus_data))
print(nrow(clus_data))
num_obs<- nrow(clus_data)
for (col in colnames(clus_data) ){
num_na<- sum(is.na(clus_data[col]))
perc_na<- 100*num_na/num_obs
print(paste(col, num_na, perc_na))
}
loc_data<- clus_data %>% group_by(location) %>%
summarise(mean_so2 = mean(so2, na.rm=TRUE),
mean_no2 = mean(no2, na.rm=TRUE),
mean_rspm = mean(rspm, na.rm=TRUE),
mean_spm = mean(spm, na.rm=TRUE)
)
head(loc_data)
clus_data %>% filter(location="Akola") %>% mean(spm, na.rm=TRUE)
clus_data %>% filter(location=="Akola") %>% mean(spm, na.rm=TRUE)
clus_data %>% filter(location=="Akola") %>% nrow()
clus_data %>% filter(location=="Akola") %>% select(spm) %>% sum(is.na())
clus_data %>% filter(location=="Akola") %>% select(spm
clus_data %>% filter(location=="Akola") %>% select(spm)
loc_data<- clus_data %>% group_by(location) %>%
summarise(mean_so2 = mean(so2, na.rm=TRUE),
mean_no2 = mean(no2, na.rm=TRUE),
mean_rspm = mean(rspm, na.rm=TRUE),
mean_spm = mean(spm, na.rm=TRUE)
)
head(loc_data)
num_loc = nrow(loc_data)
for (col in colnames(loc_data) ){
num_na<- sum(is.na(loc_data[col]))
perc_na<- 100*num_na/num_loc
print(paste(col, num_na, perc_na))
}
for (col in colnames(clus_data) ){
num_na<- sum(is.na(clus_data[col]))
perc_na<- 100*num_na/num_obs
print(paste(col, num_na, perc_na))
}
### remove rows with missing location
clus_data<- clus_data[!is.na(clus_data$location)]
### remove rows with missing location
clus_data<- clus_data[is.na(clus_data$location)]
colnames(clus_data)
clus_data$location
is.na(clus_data$location)
### remove rows with missing location
clus_data<- clus_data[!is.na(clus_data$location), ]
loc_data<- clus_data %>% group_by(location) %>%
summarise(mean_so2 = mean(so2, na.rm=TRUE),
mean_no2 = mean(no2, na.rm=TRUE),
mean_rspm = mean(rspm, na.rm=TRUE),
mean_spm = mean(spm, na.rm=TRUE)
)
head(loc_data)
num_loc = nrow(loc_data)
for (col in colnames(loc_data) ){
num_na<- sum(is.na(loc_data[col]))
perc_na<- 100*num_na/num_loc
print(paste(col, num_na, perc_na))
}
loc_data$mean_so2[is.na(loc_data$mean_so2)]= mean(loc_data$mean_so2, na.rm = TRUE)
loc_data$mean_so2[is.na(loc_data$mean_so2)]= mean(loc_data$mean_so2, na.rm = TRUE)
loc_data$mean_no2[is.na(loc_data$mean_no2)]= mean(loc_data$mean_no2, na.rm = TRUE)
loc_data$mean_rspm[is.na(loc_data$mean_rspm)]= mean(loc_data$mean_rspm, na.rm = TRUE)
loc_data<- loc_data %>% select(-c(mean_spm))
head(loc_data)
clean_loc_data<- loc_data %>% select(-c(mean_spm))
head(clean_loc_data)
head(loc_data)
for (col in colnames(loc_data) ){
num_na<- sum(is.na(loc_data[col]))
perc_na<- 100*num_na/num_loc
print(paste(col, num_na, perc_na))
}
loc_data<- clus_data %>% group_by(location) %>%
summarise(mean_so2 = mean(so2, na.rm=TRUE),
mean_no2 = mean(no2, na.rm=TRUE),
mean_rspm = mean(rspm, na.rm=TRUE),
mean_spm = mean(spm, na.rm=TRUE)
)
head(loc_data)
num_loc = nrow(loc_data)
for (col in colnames(loc_data) ){
num_na<- sum(is.na(loc_data[col]))
perc_na<- 100*num_na/num_loc
print(paste(col, num_na, perc_na))
}
loc_data$mean_so2[is.na(loc_data$mean_so2)]= mean(loc_data$mean_so2, na.rm = TRUE)
loc_data$mean_no2[is.na(loc_data$mean_no2)]= mean(loc_data$mean_no2, na.rm = TRUE)
loc_data$mean_rspm[is.na(loc_data$mean_rspm)]= mean(loc_data$mean_rspm, na.rm = TRUE)
clean_loc_data<- loc_data %>% select(-c(mean_spm))
head(clean_loc_data)
boxplot(clean_loc_data$mean_so2, main = "Boxplot for mean_so2")
boxplot(clean_loc_data$mean_no2, main = "Boxplot for mean_no2")
boxplot(clean_loc_data$mean_rspm, main = "Boxplot for mean_rspm")
clean_loc_data<- scale(clean_loc_data, center=TRUE, scale=TRUE)
head(clean_loc_data[-c(location)])
head(clean_loc_data[,-c(location)])
head(clean_loc_data[-c(location),])
head(clean_loc_data["mean_no2"])
for (mean_col in c("mean_so2", "mean_no2", "mean_rspm")){
clean_loc_data[mean_col]<- scale(clean_loc_data[mean_col], center=TRUE, scale=TRUE)
}
head(mean_col)
head(clean_loc_data)
library(cluster)
?kmeans
clus_loc<- kmeans(clean_loc_data, 3, centers = 10)
str(clean_loc_data)
clus_loc<- kmeans(clean_loc_data, 3, centers = 10)
rownames(clean_loc_data)<- clean_loc_data$location
clean_loc_data<- clan_loc_data %>% select(-c(location))
clean_loc_data<- clean_loc_data %>% select(-c(location))
head(clean_loc_data)
### summarise mean for each location
loc_data<- clus_data %>% group_by(location) %>%
summarise(mean_so2 = mean(so2, na.rm=TRUE),
mean_no2 = mean(no2, na.rm=TRUE),
mean_rspm = mean(rspm, na.rm=TRUE),
mean_spm = mean(spm, na.rm=TRUE)
)
head(loc_data)
### summarise mean for each location
loc_data<- clus_data %>% group_by(location) %>%
summarise(mean_so2 = mean(so2, na.rm=TRUE),
mean_no2 = mean(no2, na.rm=TRUE),
mean_rspm = mean(rspm, na.rm=TRUE),
mean_spm = mean(spm, na.rm=TRUE)
) %>% data.frame()
head(loc_data)
num_loc = nrow(loc_data)
for (col in colnames(loc_data) ){
num_na<- sum(is.na(loc_data[col]))
perc_na<- 100*num_na/num_loc
print(paste(col, num_na, perc_na))
}
loc_data$mean_so2[is.na(loc_data$mean_so2)]= mean(loc_data$mean_so2, na.rm = TRUE)
loc_data$mean_no2[is.na(loc_data$mean_no2)]= mean(loc_data$mean_no2, na.rm = TRUE)
loc_data$mean_rspm[is.na(loc_data$mean_rspm)]= mean(loc_data$mean_rspm, na.rm = TRUE)
clean_loc_data<- loc_data %>% select(-c(mean_spm))
head(clean_loc_data)
boxplot(clean_loc_data$mean_so2, main = "Boxplot for mean_so2")
boxplot(clean_loc_data$mean_no2, main = "Boxplot for mean_no2")
boxplot(clean_loc_data$mean_rspm, main = "Boxplot for mean_rspm")
for (mean_col in c("mean_so2", "mean_no2", "mean_rspm")){
clean_loc_data[mean_col]<- scale(clean_loc_data[mean_col], center=TRUE, scale=TRUE)
}
rownames(clean_loc_data)<- clean_loc_data$location
clean_loc_data<- clean_loc_data %>% select(-c(location))
head(clean_loc_data)
clus_loc<- kmeans(clean_loc_data, 3, centers = 10)
clus_loc<- kmeans(clean_loc_data, 5, centers = 10)
clus_loc<- kmeans(clean_loc_data, centers = 3, nstart = 10)
head(clus_loc)
head(clus_loc$cluster)
