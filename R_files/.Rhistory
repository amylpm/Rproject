knitr::opts_chunk$set(echo = TRUE)
plotdata <- df %>%
count(location) %>%
mutate(pct = n / sum(n),
pctlabel = paste0(round(pct*100), "%")) %>%
arrange(desc(n)) %>%
head(10)
plotdata <- df %>%
count(location) %>%
mutate(pct = n / sum(n),
pctlabel = paste0(round(pct*100), "%")) %>%
arrange(desc(n))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(scales)
library(grid)
library(tidyr)
library(rstudioapi)
library(tidyverse)
library(lubridate,magrittr)
library(ggfortify)
library(tseries)
library('vars')
library('quantmod')
library(forecast)
main_dir<- dirname(dirname(rstudioapi::getSourceEditorContext()$path))
datadir<- paste0(main_dir,"/data")
data_path<- paste0(datadir,"/data.csv")
df=read.csv(data_path)
head(df)
str(df)
summary(df)
df$sampling_date=NULL
df$stn_code=NULL
df$agency=NULL
df$location_monitoring_station=NULL
head(df)
plotdata <- df %>%
count(state) %>%
mutate(pct = n / sum(n),
pctlabel = paste0(round(pct*100), "%"))
ggplot(plotdata, aes(x=reorder(state, n),y=pct)) +
geom_bar(stat = "identity", fill = "lightgreen") +
geom_text(aes(label = pctlabel), vjust = -0.25) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
scale_y_continuous(labels = percent) +
labs(y = "Percentage",x="State", title = "Percentage of Recording From Each State")
plotdata <- df %>%
count(location) %>%
mutate(pct = n / sum(n),
pctlabel = paste0(round(pct*100), "%")) %>%
arrange(desc(n))
plotdata
ggplot(plotdata, aes(x = reorder(location, n),y=pct)) +
geom_bar(stat = "identity", fill = "lightgreen") +
geom_text(aes(label = pctlabel), vjust = -0.25) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))+
scale_y_continuous(labels = percent) +
labs(y = "Percentage", title = "Percentage of Recording From Each Location")
