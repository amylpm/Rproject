df=read.csv(file="data.csv")
head(df)
str(df)
for(i in 1:13){
x=sum(is.na(df[i]))
y=c(names(df[i]),x)
print(y)}
df$sampling_date=NULL
df$stn_code=NULL
df$agency=NULL
df$location_monitoring_station=NULL
head(df)
df$type[df$type %in% "Residential, Rural and other Areas"] <- "Residential"
df$type[df$type %in% "Residential and others"] <- "Residential"
df$type[df$type %in% "Industrial Area"] <- "Industrial"
df$type[df$type %in% "Industrial Areas"] <- "Industrial"
df$type[df$type %in% "RIRUO"] <- "Others"
df$type[df$type %in% "Sensitive"] <- "Others"
df$type[df$type %in% "Sensitive Areas"] <- "Others"
df$type[df$type %in% "Sensitive Area"] <- "Others"
df <- df %>% mutate(so2 = if_else(so2>500, mean(df$so2), df$so2))
df <- df %>% mutate(no2 = if_else(no2>500, mean(df$no2), df$no2))
df <- df %>% mutate(rspm = if_else(rspm>2000, mean(df$rspm), df$rspm))
df <- df %>% mutate(spm = if_else(spm>2000, mean(df$spm), df$spm))
df <- df %>% mutate(pm2_5 = if_else(pm2_5>2000, mean(df$pm2_5), df$pm2_5))
library(ggplot2)
library(dplyr)
library(scales)
library(tidyr)
df_ts$so2[is.na(df_ts$so2)]= mean(df_ts$so2, na.rm = TRUE)
df_ts$no2[is.na(df_ts$no2)]= mean(df_ts$no2, na.rm = TRUE)
df_ts$rspm[is.na(df_ts$rspm)]= mean(df_ts$rspm, na.rm = TRUE)
df_ts <- df_ts %>% na.omit(df_ts)
df_ts$spm=NULL
df <- df %>% mutate(so2 = if_else(so2>500, mean(df$so2), df$so2))
df <- df %>% mutate(no2 = if_else(no2>500, mean(df$no2), df$no2))
df <- df %>% mutate(rspm = if_else(rspm>2000, mean(df$rspm), df$rspm))
df <- df %>% mutate(spm = if_else(spm>2000, mean(df$spm), df$spm))
df <- df %>% mutate(pm2_5 = if_else(pm2_5>2000, mean(df$pm2_5), df$pm2_5))
head(df)
y=c(names(df[i]),x)
head(df)
for(i in 1:9){
x=sum(is.na(df[i]))
y=c(names(df[i]),x)
print(y)}
##no2 and state
plot_table <- df %>%
group_by(no2, state) %>%
count()
ggplot(plot_table, aes(x = no2, y = n)) +
geom_bar(stat = "identity", alpha = 0.7) +
facet_grid(. ~state)  +
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
geom_text(aes(label = n), fontface = "bold", vjust = 1.5, colour = "white", size = 4) +
labs(y = "Frequency\n", title = "Respondent's level of knowledge about H1N1 Flu Vaccine and Respondent's H1N1 Flu Vaccine Received")
##no2 and state
plotdata <- df %>%
group_by(state) %>%
summarize(mean_1= mean(so2))
ggplot(plotdata,
geom_bar(stat = "identity", fill = "cornflowerblue") +
scale_y_continuous(breaks = seq(0, 130000, 20000), label = dollar) +
subtitle = "9-month academic salary for 2008-2009",
##no2 and state
plotdata <- df %>%
group_by(state) %>%
summarize(mean_1= mean(so2))
ggplot(plotdata, aes(x = factor(state,labels = colnames(plotdata), y = mean_1)) +
geom_bar(stat = "identity", fill = "cornflowerblue") +
geom_text(aes(label = mean_1), vjust = -0.25) +
scale_y_continuous(breaks = seq(0, 130000, 20000), label = dollar) +
labs(title = "Mean Salary by Rank",
subtitle = "9-month academic salary for 2008-2009",
x = "",
y = ""))
##no2 and state
plotdata <- df %>%
group_by(state) %>%
summarize(mean_1= mean(so2))
plotdata
##no2 and state
plotdata <- df %>%
group_by(state) %>%
summarize(mean_1= count(so2))
plotdata
plotdata <- df %>%
tapply(so2,state,mean)
plotdata <- df %>%
tapply(df$so2,df$state,mean)
tapply(df$so2,df$state,mean)
tapply(df$so2,df$state,mean)
tapply(df$no2,df$state,mean)
df=read.csv(file="data.csv")
head(df)
str(df)
for(i in 1:13){
x=sum(is.na(df[i]))
y=c(names(df[i]),x)
print(y)}
df$sampling_date=NULL
df$stn_code=NULL
df$agency=NULL
df$location_monitoring_station=NULL
head(df)
df$type[df$type %in% "Residential, Rural and other Areas"] <- "Residential"
df$type[df$type %in% "Residential and others"] <- "Residential"
df$type[df$type %in% "Industrial Area"] <- "Industrial"
df$type[df$type %in% "Industrial Areas"] <- "Industrial"
df$type[df$type %in% "RIRUO"] <- "Others"
df$type[df$type %in% "Sensitive"] <- "Others"
df$type[df$type %in% "Sensitive Areas"] <- "Others"
df$type[df$type %in% "Sensitive Area"] <- "Others"
df <- df %>% mutate(so2 = if_else(so2>500, mean(df$so2), df$so2))
df <- df %>% mutate(no2 = if_else(no2>500, mean(df$no2), df$no2))
df <- df %>% mutate(rspm = if_else(rspm>2000, mean(df$rspm), df$rspm))
df <- df %>% mutate(spm = if_else(spm>2000, mean(df$spm), df$spm))
df <- df %>% mutate(pm2_5 = if_else(pm2_5>2000, mean(df$pm2_5), df$pm2_5))
head(df)
tapply(df$no2,df$state,mean)
tapply(df$no2,df$type,mean)
tapply(df$type,df$no2,mean)
tapply(df$so2,df$type,mean(df$so2))
head(df)
for(i in 1:9){
x=sum(is.na(df[i]))
y=c(names(df[i]),x)
print(y)}
#subset for ts regression
df_ts=subset(df, !is.na(pm2_5))
head(df_ts)
str(df_ts)
for(i in 1:9){
x=sum(is.na(df_ts[i]))
y=c(names(df_ts[i]),x)
print(y)}
df_ts$so2[is.na(df_ts$so2)]= mean(df_ts$so2, na.rm = TRUE)
df_ts$no2[is.na(df_ts$no2)]= mean(df_ts$no2, na.rm = TRUE)
df_ts$rspm[is.na(df_ts$rspm)]= mean(df_ts$rspm, na.rm = TRUE)
df_ts <- df_ts %>% na.omit(df_ts)
df_ts$spm=NULL
for(i in 1:8){
x=sum(is.na(df_ts[i]))
y=c(names(df_ts[i]),x)
print(y)}
write.csv(df_ts)
getwd()
help("write.csv")
write.csv(df_ts,"data_ts.csv")
df_ts
#subset for ts regression
df_ts=subset(df, !is.na(pm2_5))
head(df_ts)
str(df_ts)
for(i in 1:9){
x=sum(is.na(df_ts[i]))
y=c(names(df_ts[i]),x)
print(y)}
df_ts$so2[is.na(df_ts$so2)]= mean(df_ts$so2, na.rm = TRUE)
df_ts$no2[is.na(df_ts$no2)]= mean(df_ts$no2, na.rm = TRUE)
df_ts$rspm[is.na(df_ts$rspm)]= mean(df_ts$rspm, na.rm = TRUE)
df_ts
df_ts$rspm[is.na(df_ts$rspm)]= mean(df_ts$rspm, na.rm = TRUE)
df_ts
df_ts$spm=NULL
df_ts
for(i in 1:8){
x=sum(is.na(df_ts[i]))
y=c(names(df_ts[i]),x)
print(y)}
df_ts
getwd()
write.csv(df_ts,"data_ts.csv")
help("write.csv")
write.csv(df_ts,"data_ts.csv", col.names=FALSE)
sort(df_ts$date,decreasing=FALSE)
df_ts=df_ts[order(df_ts$date,decreasing=FALSE)]
order(df_ts$date,decreasing=FALSE)
df_ts=df_ts[,(order(df_ts$date,decreasing=FALSE))]
df_ts=df_ts[(order(df_ts$date,decreasing=FALSE)),]
df_ts
write.csv(df_ts,"data_ts.csv", col.names=TRUE, row.names=FALSE)
write.csv(df_ts,"data_ts.csv", row.names=FALSE)
str(df_ts)
df_c=df
df_c$pm2_5=NULL
df_c
df_c=df
df_c$pm2_5=NULL
df_C$date=NULL
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
head(df_c)
df_C$date=NULL
df_c$date=NULL
head(df_c)
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
df_c$type[is.na(df_c$type]= "Others"
df_c$type[is.na(df_c$type)]= "Others"
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
df <- df %>% mutate(pm2_5 = if_else(pm2_5>2000, mean(df$pm2_5), df$pm2_5))
df$type[is.na(df$type)]= "Others"
for(i in 1:9){
x=sum(is.na(df[i]))
y=c(names(df[i]),x)
print(y)}
df_c=df
df_c$pm2_5=NULL
df_c$date=NULL
head(df_c)
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
df$type[is.na(df$so2)]= mean(df_c$so2, na.rm = TRUE)
df$type[is.na(df$no2)]= mean(df_c$no2, na.rm = TRUE)
df$type[is.na(df$rspm)]= mean(df_c$rspm, na.rm = TRUE)
df$type[is.na(df$spm)]= mean(df_c$spm, na.rm = TRUE)
df <- df %>%   na.omit(df)
df_c
df=read.csv(file="data.csv")
head(df)
str(df)
for(i in 1:13){
x=sum(is.na(df[i]))
y=c(names(df[i]),x)
print(y)}
df$sampling_date=NULL
df$stn_code=NULL
df$agency=NULL
df$location_monitoring_station=NULL
head(df)
df$type[df$type %in% "Residential, Rural and other Areas"] <- "Residential"
df$type[df$type %in% "Residential and others"] <- "Residential"
df$type[df$type %in% "Industrial Area"] <- "Industrial"
df$type[df$type %in% "Industrial Areas"] <- "Industrial"
df$type[df$type %in% "RIRUO"] <- "Others"
df$type[df$type %in% "Sensitive"] <- "Others"
df$type[df$type %in% "Sensitive Areas"] <- "Others"
df$type[df$type %in% "Sensitive Area"] <- "Others"
df$type[is.na(df$type)]= "Others"
df <- df %>% mutate(so2 = if_else(so2>500, mean(df$so2), df$so2))
df <- df %>% mutate(no2 = if_else(no2>500, mean(df$no2), df$no2))
df <- df %>% mutate(rspm = if_else(rspm>2000, mean(df$rspm), df$rspm))
df <- df %>% mutate(spm = if_else(spm>2000, mean(df$spm), df$spm))
df <- df %>% mutate(pm2_5 = if_else(pm2_5>2000, mean(df$pm2_5), df$pm2_5))
df_c=df
df_c$pm2_5=NULL
df_c$date=NULL
head(df_c)
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
df_c$type[is.na(df$so2)]= mean(df_c$so2, na.rm = TRUE)
df_c$type[is.na(df$no2)]= mean(df_c$no2, na.rm = TRUE)
df_c$type[is.na(df$rspm)]= mean(df_c$rspm, na.rm = TRUE)
df_c$type[is.na(df$spm)]= mean(df_c$spm, na.rm = TRUE)
df_C <- df_C %>% na.omit(df_c)
df_c <- df_c %>% na.omit(df_c)
for(i in 1:7){
x=sum(is.na(df_c[i]))
print(paste(names(df_c[i]),x))}
write.csv(df_c,"data_c.csv", row.names=FALSE)
